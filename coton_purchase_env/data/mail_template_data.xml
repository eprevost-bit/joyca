<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <record id="email_template_purchase_selected_lines" model="mail.template">
            <field name="name">Enviar Partidas de Compra Seleccionadas</field>
            <field name="model_id" ref="purchase.model_purchase_order"/>
            <field name="email_from">{{ (object.user_id.email_formatted or user.email_formatted) }}</field>
            <field name="partner_to">{{ object.partner_id.id }}</field>
            <field name="subject">{{ object.company_id.name }} - Solicitud de Presupuesto {{ object.name }}</field>
            <field name="body_html"><![CDATA[
<div style="margin: 0px; padding: 0px; font-family: 'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 13px;">

    <p>Estimado/a <strong><t t-out="object.partner_id.name or ''">Proveedor</t></strong>,</p>

    <p>
        Aquí se adjunta una solicitud de presupuesto <strong><t t-out="object.name or ''">nº de presupuesto</t></strong> de <strong><t t-out="object.company_id.name or ''">Empresa</t></strong>
    </p>

    <table class="table table-sm" style="border-collapse: collapse; width: 100%; margin-top: 20px; margin-bottom: 20px;">
        <thead style="background-color: #f2f2f2;">
            <tr>
                <th style="border: 1px solid #ddd; padding: 8px;">Producto</th>
                <th style="border: 1px solid #ddd; padding: 8px;">Cantidad</th>
            </tr>
        </thead>
        <tbody>
            <t t-set="selected_lines" t-value="object.order_line.filtered(lambda line: line.id in ctx.get('selected_line_ids', []))"/>
            <t t-foreach="selected_lines" t-as="line">
                <tr>
                    <td style="border: 1px solid #ddd; padding: 8px;"><t t-out="line.name or ''"/></td>
                    <td style="border: 1px solid #ddd; padding: 8px;"><t t-out="line.product_qty or ''"/> <t t-out="line.product_uom.name or ''"/></td>
                </tr>
            </t>
        </tbody>
    </table>

    <p>No dude en contactarnos si tiene alguna pregunta.</p>

    <p>Saludos,</p>
    <br/>
    <p t-out="object.user_id.name or ''"></p>

</div>
            ]]></field>
        </record>
    </data>
</odoo>